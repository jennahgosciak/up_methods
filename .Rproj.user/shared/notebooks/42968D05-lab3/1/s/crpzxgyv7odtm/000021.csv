"0","create_lutable2 <- function(df) {"
"0","  df %>% "
"0","    group_by(zonedist1) %>%"
"0","    summarize(across(c(total_unutilized,"
"0","                       utilized,"
"0","                       max_area_allow), sum, na.rm = T)) %>% "
"0","    ungroup() %>% "
"0","    mutate(per_unutil = round(total_unutilized * 100 / sum(total_unutilized, na.rm = T)),"
"0","           per_util = round(utilized * 100 / sum(utilized, na.rm = T)),"
"0","           per_max_allow = round(max_area_allow * 100 / sum(max_area_allow, na.rm = T))) %>% "
"0","    mutate(across(starts_with(""per_""), ~str_c(., ""%""))) %>% "
"0","    select(zonedist1, total_unutilized,"
"0","           per_unutil, utilized,"
"0","           per_util, max_area_allow,"
"0","           per_max_allow)"
"0","}"
"0",""
"0","df_sub %>% "
"0","  create_lutable2() %>% "
"0","  bind_rows(df_sub %>%"
"0","              mutate(zonedist1 = ""Total"") %>% "
"0","              create_lutable2()) %>%"
"0","  mutate(order = if_else(zonedist1 == ""Total"", 1, 0)) %>% "
"0","  arrange(order, -total_unutilized) %>% "
"0","  select(-""order"") %>% "
"0","  rename_all(~c(""Zoning Code"", ""Total Unutilized FAR (sqft)"", ""Share of Total Unutilized FAR"","
"0","               ""Total Utilized FAR (sqft)"", ""Share of Total Utilized FAR (sqft)"","
"0","               ""Total Max Floor Area Allowed (sqft)"", ""Share of Total Max Floor Area Allowed"")) %>%"
"0","  mutate(across(c(""Total Unutilized FAR (sqft)"","
"0","                  ""Total Utilized FAR (sqft)"","
"0","                  ""Total Max Floor Area Allowed (sqft)""), ~scales::comma(., accuracy = 1))) %>% "
"0","  kbl(align=c(rep('l',times=7))) %>% "
"0","  kable_styling(position = ""left"","
"0","                latex_options = c(""hold_position"")) %>%"
"0","  column_spec(1, width = ""15em"", bold = TRUE, border_left = TRUE) %>% "
"0","  column_spec(2:6, width = ""7em"") %>% "
"0","  column_spec(7, width = ""7em"", border_right = TRUE)  %>% "
"0","  row_spec(0, bold = TRUE)"
